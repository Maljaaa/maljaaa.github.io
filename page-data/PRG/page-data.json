{"componentChunkName":"component---src-templates-blog-template-js","path":"/PRG/","result":{"data":{"cur":{"id":"adcb28db-f486-5b76-8cc6-bf422692eaf7","html":"<h2 id=\"intro\" style=\"position:relative;\"><a href=\"#intro\" aria-label=\"intro permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Intro</h2>\n<p>코드를 보다가 <strong>Redirect Strategy</strong> 부분의 코드를 보게 되었다. 평소에 알던 리다이렉트는 그저 서버가 어떤 URL로 강제로 View를 보여주는 것이라고만 생각해왔다. 하지만 이번 공부를 통해 조금 다른 부분까지 알게 되어서 정리해보고자 한다.</p>\n<h3 id=\"멱등성\" style=\"position:relative;\"><a href=\"#%EB%A9%B1%EB%93%B1%EC%84%B1\" aria-label=\"멱등성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>멱등성</h3>\n<p><strong>PRG패턴</strong>을 이야기하는데 있어서 가장 먼저 이야기해야하는 것은 멱등성이다. 멱등성이란, <strong>연산을 여러번 적용하더라도 결과가 달라지지 않는 성질</strong>을 의미한다.<br>\n그렇다면 웹에서는 <code class=\"language-text\">GET</code>, <code class=\"language-text\">HEAD</code>, <code class=\"language-text\">PUT</code>, <code class=\"language-text\">DELETE</code>는 멱등성을 가진다라고 말할 수 있다.<br>\n하지만 <code class=\"language-text\">POST</code>는 멱등성을 가지지 않는다.</p>\n<p>예를 들어보면, <code class=\"language-text\">GET</code>은 얼마든지 자주 호출해도 같은 결과를 나타내지만, 게시글을 등록하는 <code class=\"language-text\">POST</code>를 연달아 호출하면 호출한 횟수만큼 게시글이 등록된다.</p>\n<p>하지만 REDIRECT가 아니라 FORWARD로 처리할 경우 새로고침 시 게시글 작성/주문이 중복해서 처리될 수 있다.</p>\n<h3 id=\"prg-패턴\" style=\"position:relative;\"><a href=\"#prg-%ED%8C%A8%ED%84%B4\" aria-label=\"prg 패턴 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PRG 패턴</h3>\n<p>위와 같은 이유로 PSG 패턴은 꼭 필요하다. 그렇다면 더 자세히 알아보자.</p>\n<p><code class=\"language-text\">PSG 패턴</code>은 웹 개발 시 권장되는 디자인 패턴으로<br>\n멱등성을 보장하고 POST에 대한 결과를 다른 사용자가 공유하기 위해 사용되는 패턴이다. <code class=\"language-text\">POST -> REDIRECT -> GET</code>을 줄여서 <code class=\"language-text\">PRG</code>라고 한다.</p>\n<p><code class=\"language-text\">POST</code> 요청이 오면 해당 요청을 수행 후 <code class=\"language-text\">REDIRECT</code>를 시켜서 <code class=\"language-text\">GET</code> 요청으로 변환시키는 행위를 의미한다.</p>\n<h3 id=\"포워딩-vs-리다이렉트\" style=\"position:relative;\"><a href=\"#%ED%8F%AC%EC%9B%8C%EB%94%A9-vs-%EB%A6%AC%EB%8B%A4%EC%9D%B4%EB%A0%89%ED%8A%B8\" aria-label=\"포워딩 vs 리다이렉트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>포워딩 vs 리다이렉트</h3>\n<ol>\n<li>\n<p><strong>포워딩</strong> : 서버 내부에서 일어나는 일<br>\n1️⃣ 웹 브라우저 URL 창에 /event을 입력하고 엔터</p>\n<p>2️⃣ 서버가 /event URL을 전달 받음</p>\n<p>3️⃣ 서버가 서버 내부에서 /event -> /new-event로 포워딩</p>\n<p>4️⃣ /new-event 결과를 내부에서 렌더링</p>\n<p>5️⃣ 클라이언트에게 렌더링 된 결과를 반환</p>\n<p>6️⃣ 웹 브라우저에 응답 결과가 보이고 URL 창은 처음 입력한 /event로 유지됨</p>\n</li>\n<li>\n<p><strong>리다이렉트</strong> : 웹 브라우저가 인식하고 URL 경로를 실제 변경\r\n1️⃣ 웹 브라우저 URL 창에 /event을 입력하고 엔터</p>\n<p>2️⃣ 서버가 /event URL을 전달 받음</p>\n<p>3️⃣ 서버가 /event -> /new-event로 리다이렉트</p>\n<p>4️⃣ 서버는 /new-event로 리다이렉트 하라는 결과를 웹 브라우저에 반환</p>\n<p>5️⃣ 웹 브라우저는 URL 창에 자동으로 /new-event를 입력하고 엔터(자동으로 일어나고, 실제 URL 창에 입력 결과가 /new-event로 변경됨)</p>\n<p>6️⃣ 서버가 /new-event URL을 전달 받음</p>\n<p>7️⃣ /new-event 결과를 내부에서 렌더링</p>\n<p>8️⃣ 클라이언트에게 렌더링 된 결과를 반환</p>\n<p>9️⃣ 웹 브라우저에 응답 결과가 보이고 URL 창은 리다이렉트 된 /new-event로 유지됨</p>\n</li>\n</ol>\n<h3 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h3>\n<p>지금까지 <strong>REDIRECT</strong>는 화면을 서버에서 정해주는 것이라고만 생각했다. 하지만 지금 공부를 하고나서는 달라졌다. <strong>REDIRECT</strong>는 멱등하지 않은 POST가 반복해서 요청하는 것을 방지하기 위해 사용한다. 그리고 클라이언트의 요청을 <strong>REDIRECT</strong>로 <strong>다른 URL</strong>을 보냄으로써 다시금 그 <strong>URL</strong> 요청을 받는다. 그 요청을 응답으로 내주면 된다.</p>\n<p><a href=\"https://www.inflearn.com/questions/89530/redirect%EC%9D%B4%EC%9C%A0%EA%B0%80-%EA%B6%81%EA%B8%88%ED%95%A9%EB%8B%88%EB%8B%A4\">인프런 질문</a><br>\n<a href=\"https://gofo-coding.tistory.com/entry/PRG-%ED%8C%A8%ED%84%B4-Post-%E2%86%92-Redirect-%E2%86%92-Get\">PRG 패턴 : Post → Redirect → Get</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#intro\">Intro</a></p>\n<ul>\n<li><a href=\"#%EB%A9%B1%EB%93%B1%EC%84%B1\">멱등성</a></li>\n<li><a href=\"#prg-%ED%8C%A8%ED%84%B4\">PRG 패턴</a></li>\n<li><a href=\"#%ED%8F%AC%EC%9B%8C%EB%94%A9-vs-%EB%A6%AC%EB%8B%A4%EC%9D%B4%EB%A0%89%ED%8A%B8\">포워딩 vs 리다이렉트</a></li>\n<li><a href=\"#%EC%A0%95%EB%A6%AC\">정리</a></li>\n</ul>\n</li>\n</ul>\n</div>","excerpt":"Intro 코드를 보다가 Redirect Strategy 부분의 코드를 보게 되었다. 평소에 알던 리다이렉트는 그저 서버가 어떤 URL로 강제로 View를 보여주는 것이라고만 생각해왔다. 하지만 이번 공부를 통해 조금 다른 부분까지 알게 되어서 정리해보고자 한다. 멱등성 PRG패턴을 이야기하는데 있어서 가장 먼저 이야기해야하는 것은 멱등성이다. 멱등성이란, 연산을 여러번 적용하더라도 결과가 달라지지 않는 성질을 의미한다. 그렇다면 웹에서는 , , , 는 멱등성을 가진다라고 말할 수 있다. 하지만 는 멱등성을 가지지 않는다. 예를 들어보면, 은 얼마든지 자주 호출해도 같은 결과를 나타내지만, 게시글을 등록하는 를 연달아 호출하면 호출한 횟수만큼 게시글이 등록된다. 하지만 REDIRECT가 아니라 FORWARD로 처리할 경우 새로고침 시 게시글 작성/주문이 중복해서 처리될 수 있다. PRG 패턴 위와 같은 이유로 PSG 패턴은 꼭 필요하다. 그렇다면 더 자세히 알아보자. 은 웹 개발 …","frontmatter":{"date":"June 04, 2024","title":"PRG(Post-Redirect-Get)","categories":"SpringMVC","author":"신승민","emoji":"😴"},"fields":{"slug":"/PRG/"}},"next":{"id":"5f3a2da3-7c42-5ca8-9da7-847687113763","html":"<h2 id=\"intro\" style=\"position:relative;\"><a href=\"#intro\" aria-label=\"intro permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Intro</h2>\n<p>저번 Google Sheets API에 이어서, 이번엔 Google Apps Script이다.<br>\n난 시트 내에서 계산식이 자동으로 다음줄에도 계산이 되어야한다는 요구사항을 받았다.<br>\n그래서 여러 방법을 고민하기 시작했다…</p>\n<ol>\n<li><strong>Google Sheets</strong> 내의 함수나 기능 활용하기</li>\n<li><strong>Java/Javascript</strong> 로 가져와서 계산식을 적용하고 다시 뿌려주기</li>\n<li><strong>Apps Script</strong> 활용하기</li>\n</ol>\n<p>1번은 찾지 못했다. 2번은 작성해야 하는 코드가 많아서 번거로웠다. 그래서 나는 3번인 Apps Script를 활용하기로 결정했다.<br>\n<strong>앱 스크립트(App Script)</strong> 는 구글 워크스페이스 플랫폼에서 가벼운 애플리케이션 개발을 위해 구글이 개발한 스크립팅 플랫폼이다.<br>\n난 이걸 활용하여 자동으로 계산식에 이어서 계산이 되는 기능을 구현하고자 한다.</p>\n<p>하지만 난 Apps Script가 처음이기 때문에 어떻게 접근해야할 지 몰랐다.<br>\n그러다 팀장님이 귀뜸해주신 말씀에 도움을 얻어서 매크로를 활용했다.<br>\n매크로를 기록하고 관리 페이지에서 스크립트 수정이 가능하다.  이걸로 관련 함수와 구현 방법에 대해 익숙해질 수 있었다.</p>\n<h2 id=\"구현-로직\" style=\"position:relative;\"><a href=\"#%EA%B5%AC%ED%98%84-%EB%A1%9C%EC%A7%81\" aria-label=\"구현 로직 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>구현 로직</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">스프레드 시트 연결 -> 특정 범위 지정 -> 비어 있지 않은 셀 찾기 -> 마지막 셀 찾기 -> 연산 수행</code></pre></div>\n<h3 id=\"1-스프레드-시트-연결\" style=\"position:relative;\"><a href=\"#1-%EC%8A%A4%ED%94%84%EB%A0%88%EB%93%9C-%EC%8B%9C%ED%8A%B8-%EC%97%B0%EA%B2%B0\" aria-label=\"1 스프레드 시트 연결 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1) 스프레드 시트 연결</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> spreadsheet <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActive</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </code></pre></div>\n<p>가장 먼저 스프레드 시트와 연결을 해야하는데 확장 프로그램이다 보니, <code class=\"language-text\">Google Sheets API</code>처럼 복잡한 코드가 아니다.</p>\n<h3 id=\"2-특정-범위-지정\" style=\"position:relative;\"><a href=\"#2-%ED%8A%B9%EC%A0%95-%EB%B2%94%EC%9C%84-%EC%A7%80%EC%A0%95\" aria-label=\"2 특정 범위 지정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2) 특정 범위 지정</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> range <span class=\"token operator\">=</span> spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token string\">'범위(B2:C3)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \r\n  \r\n<span class=\"token keyword\">var</span> numRows <span class=\"token operator\">=</span> range<span class=\"token punctuation\">.</span><span class=\"token function\">getNumRows</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">var</span> numCols <span class=\"token operator\">=</span> range<span class=\"token punctuation\">.</span><span class=\"token function\">getNumColumns</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>범위를 지정해야 기준이 생긴다.</p>\n<blockquote>\n<p>그렇다면 범위는 무작정 작게 하는게 좋을까? 무작정 크게 늘려 놓는게 좋을까?</p>\n</blockquote>\n<h3 id=\"3-비어-있지-않은-셀-찾기\" style=\"position:relative;\"><a href=\"#3-%EB%B9%84%EC%96%B4-%EC%9E%88%EC%A7%80-%EC%95%8A%EC%9D%80-%EC%85%80-%EC%B0%BE%EA%B8%B0\" aria-label=\"3 비어 있지 않은 셀 찾기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3) 비어 있지 않은 셀 찾기</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> nonEmptyCells <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n  \r\n<span class=\"token comment\">// 지정한 범위 내에서 비어 있지 않은 셀을 찾아 nonEmptyCells 배열에 추가</span>\r\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> row <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> row <span class=\"token operator\">&lt;=</span> numRows<span class=\"token punctuation\">;</span> row<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> col <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> col <span class=\"token operator\">&lt;=</span> numCols<span class=\"token punctuation\">;</span> col<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">var</span> cellValue <span class=\"token operator\">=</span> range<span class=\"token punctuation\">.</span><span class=\"token function\">getCell</span><span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cellValue <span class=\"token operator\">!==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            nonEmptyCells<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">row</span><span class=\"token operator\">:</span> row<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">column</span><span class=\"token operator\">:</span> col<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>값이 있다면 어떤 값이 어느 위치에 있는지 배열에 담아두는 것이다.</p>\n<blockquote>\n<p>그러다 빈 값이 나오겠지?</p>\n</blockquote>\n<h3 id=\"4-마지막-셀-찾기\" style=\"position:relative;\"><a href=\"#4-%EB%A7%88%EC%A7%80%EB%A7%89-%EC%85%80-%EC%B0%BE%EA%B8%B0\" aria-label=\"4 마지막 셀 찾기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4) 마지막 셀 찾기</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>nonEmptyCells<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">var</span> firstCell <span class=\"token operator\">=</span> nonEmptyCells<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">var</span> lastCell <span class=\"token operator\">=</span> nonEmptyCells<span class=\"token punctuation\">[</span>nonEmptyCells<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"비어 있지 않은 셀의 범위: \"</span> <span class=\"token operator\">+</span> range<span class=\"token punctuation\">.</span><span class=\"token function\">getCell</span><span class=\"token punctuation\">(</span>firstCell<span class=\"token punctuation\">.</span>row<span class=\"token punctuation\">,</span> firstCell<span class=\"token punctuation\">.</span>column<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getA1Notation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\" - \"</span> <span class=\"token operator\">+</span> range<span class=\"token punctuation\">.</span><span class=\"token function\">getCell</span><span class=\"token punctuation\">(</span>lastCell<span class=\"token punctuation\">.</span>row<span class=\"token punctuation\">,</span> lastCell<span class=\"token punctuation\">.</span>column<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getA1Notation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    \r\n    \r\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">var</span> lastRangeCell <span class=\"token operator\">=</span> range<span class=\"token punctuation\">.</span><span class=\"token function\">getCell</span><span class=\"token punctuation\">(</span>lastCell<span class=\"token punctuation\">.</span>row<span class=\"token punctuation\">,</span> lastCell<span class=\"token punctuation\">.</span>column <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getA1Notation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">var</span> inputRange <span class=\"token operator\">=</span> <span class=\"token string\">'G3:'</span> <span class=\"token operator\">+</span> lastRangeCell<span class=\"token punctuation\">;</span>\r\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"가장 마지막 셀 : \"</span> <span class=\"token operator\">+</span> lastRangeCell<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        \r\n        <span class=\"token operator\">...</span>\r\n\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token operator\">...</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>거기가 마지막 셀, 하지만 그 다음줄에 또 이어지면 계속 빈 값을 무시하고 이어진다.</p>\n<h3 id=\"5-연산-수행\" style=\"position:relative;\"><a href=\"#5-%EC%97%B0%EC%82%B0-%EC%88%98%ED%96%89\" aria-label=\"5 연산 수행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5) 연산 수행</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> currentCell <span class=\"token operator\">=</span> spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getCurrentCell</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>        \r\n<span class=\"token keyword\">var</span> nowColumn <span class=\"token operator\">=</span> currentCell<span class=\"token punctuation\">.</span><span class=\"token function\">getColumn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">var</span> currentCellAlpha <span class=\"token operator\">=</span> currentCell<span class=\"token punctuation\">.</span><span class=\"token function\">getA1Notation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>nowColumn <span class=\"token operator\">==</span> <span class=\"token number\">6</span> <span class=\"token operator\">&amp;&amp;</span> currentCell<span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token string\">'수식이 있는 셀(D2)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">activate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveRange</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">autoFill</span><span class=\"token punctuation\">(</span>spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>inputRange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> SpreadsheetApp<span class=\"token punctuation\">.</span>AutoFillSeries<span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT_SERIES</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   \r\n    spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>currentCellAlpha<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">activate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"현재 선택한 셀 : \"</span> <span class=\"token operator\">+</span> currentCellAlpha<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>다 찾았으면 autoFill()을 활용하여 수식을 채워넣는다.</p>\n<h2 id=\"트리거\" style=\"position:relative;\"><a href=\"#%ED%8A%B8%EB%A6%AC%EA%B1%B0\" aria-label=\"트리거 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>트리거</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABNklEQVQoz51SPU/EMAzNvwfxT05igpGRBRZYQEwMMCB0atK0zUeTNnno+Y67gysIYcmKYzvPT89RRr+jtRbDMCDGCK0NjGnRdR1qrUdeSgVQcf0w4uy8R9NNKFOCDxHr9RrKuwF93wvgPM8COo4jUkqLgHQCvukJ988JYZzh/QBrO9jWQuWcUUoREJ7/Mb4jGZoaXEQIURiSKRlyCBkyDiHAe7/L0Tnch4AxZanTWWdemb7AOS/JpmmgjUHbtgLGIdRSay3aMmYvQZtGS51urd0NUs65rS7Yir6nv1tErZJj7bOX8eYOzIU9kFjlPB2Ivbfv96XaUos6ZPJ1k/hlyxDWNG774ibg8jbi8SVDLTH5Cej4PwJPrwknK4PTlcHVndswpJgUnCe1qvVvoDO/W3RAjfI36R8ZHw11SVDoMgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/b3f3c77072f58cc97eab4212ae35ff26/37523/image.png\"\n        srcset=\"/static/b3f3c77072f58cc97eab4212ae35ff26/e9ff0/image.png 180w,\n/static/b3f3c77072f58cc97eab4212ae35ff26/f21e7/image.png 360w,\n/static/b3f3c77072f58cc97eab4212ae35ff26/37523/image.png 720w,\n/static/b3f3c77072f58cc97eab4212ae35ff26/302a4/image.png 1080w,\n/static/b3f3c77072f58cc97eab4212ae35ff26/07a9c/image.png 1440w,\n/static/b3f3c77072f58cc97eab4212ae35ff26/ec09f/image.png 1916w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>위에서 코드를 다 작성했다면, 자동으로 코드가 실행되어야 하기 때문에 <strong>트리거</strong> 를 사용한다.<br>\n사진에서 보이는 것과 같이 트리거를 추가할 수 있고,<br>\n어떤걸 배포하고 어떤 이벤트에서 실행되며 어떤 함수를 실행시킬 것인지 모두 설정할 수 있다.</p>\n<blockquote>\n<p>저렇게 오류율이 조금 발생한 것은 내가 try-catch문에서 catch를 해주지 않았기 때문이다…</p>\n</blockquote>\n<p>저렇게 설정해두면, 스프레드를 수정하고 자동으로 저장이 될 때 수정이 된 시점으로 인식하여 트리거가 작동하게 된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABYElEQVQoz3VSQW7EIAzk4f1N+48+pofuNgkECMQQyKzGW1bpoZYsZGOPxwNmXmbEuGHfd6zrimWxcM6h1gO08zzVr5YEeHsP+PjcgbNBSsWyLFidhYkhIISI3jtKKRApejK+gh3HoYO3bYMPEV+3iPuSkFJCzhu+Z4ELFYaNIqIN/xkxWcea4UBTdq019N4g9cTRAMMJnBpj1LXJjnHOWafTa62aLyI6nHW7CFLKGtNLEb03XINrp5wxTZM2eh8UiEOojbUWIQQFZjNzPOd5VvAxkKfJu/yu3ODcqppdiwjEx2KO1vupOUrAeq48ZKEZFnJFNt/udy1gLLpSwjTNypxsabznT+D5M00v7ccDGgJRL34T65xOZvx8cYH3Xpkw92TYEWJUQGudAg6wFyBZ8oKatNaVGb9PzrvqR0ZkPRhSYzYPAn8YUisy4IsRnEkW9XFefDS13rWe2voQdAidgA9GfwqnzX3OMAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 1\"\n        title=\"image 1\"\n        src=\"/static/1dc13fd4d41644245b98bbd8dc6bd96d/37523/image-1.png\"\n        srcset=\"/static/1dc13fd4d41644245b98bbd8dc6bd96d/e9ff0/image-1.png 180w,\n/static/1dc13fd4d41644245b98bbd8dc6bd96d/f21e7/image-1.png 360w,\n/static/1dc13fd4d41644245b98bbd8dc6bd96d/37523/image-1.png 720w,\n/static/1dc13fd4d41644245b98bbd8dc6bd96d/302a4/image-1.png 1080w,\n/static/1dc13fd4d41644245b98bbd8dc6bd96d/07a9c/image-1.png 1440w,\n/static/1dc13fd4d41644245b98bbd8dc6bd96d/460fa/image-1.png 1910w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\r\n이렇게 실행된 결과도 힌 눈에 볼 수 있다.</p>\n<h2 id=\"나의-소감\" style=\"position:relative;\"><a href=\"#%EB%82%98%EC%9D%98-%EC%86%8C%EA%B0%90\" aria-label=\"나의 소감 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>나의 소감</h2>\n<p><strong>Google Sheets API</strong> 에 이어서 <strong>Apps Scripts</strong> 까지 해보니, 현업에서 고민되었던 문제를 해결할 수 있다는 사실에 벅찼다.<br>\n새로운 것들이었기 때문에 하나하나 알아가는 과정이 지루하지 않고 재밌었다.<br>\n다만 아직 <strong>Apps Script</strong> 에서 javascript에 익숙하지 않아서 클린코드, 객체지향적인 코드 작성을 했다고 말할 수는 없지만,<br>\n그래도 그걸 적용하고 나름대로 추출해보는 경험이 즐거웠다.<br>\n<strong>Apps Script</strong> 도 하나의 문제 해결 방법으로 고려해볼만 한 것 같다.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#intro\">Intro</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B5%AC%ED%98%84-%EB%A1%9C%EC%A7%81\">구현 로직</a></p>\n<ul>\n<li><a href=\"#1-%EC%8A%A4%ED%94%84%EB%A0%88%EB%93%9C-%EC%8B%9C%ED%8A%B8-%EC%97%B0%EA%B2%B0\">1) 스프레드 시트 연결</a></li>\n<li><a href=\"#2-%ED%8A%B9%EC%A0%95-%EB%B2%94%EC%9C%84-%EC%A7%80%EC%A0%95\">2) 특정 범위 지정</a></li>\n<li><a href=\"#3-%EB%B9%84%EC%96%B4-%EC%9E%88%EC%A7%80-%EC%95%8A%EC%9D%80-%EC%85%80-%EC%B0%BE%EA%B8%B0\">3) 비어 있지 않은 셀 찾기</a></li>\n<li><a href=\"#4-%EB%A7%88%EC%A7%80%EB%A7%89-%EC%85%80-%EC%B0%BE%EA%B8%B0\">4) 마지막 셀 찾기</a></li>\n<li><a href=\"#5-%EC%97%B0%EC%82%B0-%EC%88%98%ED%96%89\">5) 연산 수행</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%ED%8A%B8%EB%A6%AC%EA%B1%B0\">트리거</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%82%98%EC%9D%98-%EC%86%8C%EA%B0%90\">나의 소감</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"May 27, 2024","title":"Google Apps Script","categories":"Google_Sheets","author":"신승민","emoji":"🪖"},"fields":{"slug":"/Apps Script/"}},"prev":null,"site":{"siteMetadata":{"siteUrl":"https://maljaaa.github.io","comments":{"utterances":{"repo":"maljaaa/maljaaa.github.io"}}}}},"pageContext":{"slug":"/PRG/","nextSlug":"/Apps Script/","prevSlug":""}},"staticQueryHashes":["1073350324","1956554647","2938748437"]}