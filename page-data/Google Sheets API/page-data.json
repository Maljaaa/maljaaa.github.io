{"componentChunkName":"component---src-templates-blog-template-js","path":"/Google Sheets API/","result":{"data":{"cur":{"id":"44121dc5-7f70-5eac-ac7f-327db995f1e0","html":"<h2 id=\"intro\" style=\"position:relative;\"><a href=\"#intro\" aria-label=\"intro permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Intro</h2>\n<p>회사에서 수습사원을 떼고, 첫 업무가 주어졌다!!!<br>\n유관부서에서 Google Sheets로 대시보드처럼 사용하고 있었는데,<br>\nGoogle Sheets에서 편집한게 우리가 사용하는 웹 사이트에도 보였으면 좋겠다는 요구였다. 정리해보자!</p>\n<ol>\n<li>Google Sheets가 DB에 연동이 되어야한다.</li>\n<li>Google Sheets에서 계산식이 자동으로 적용되어야 한다.</li>\n<li>Google Sheets에서 변경된 내용은 웹사이트에도 반영되어야 한다.</li>\n<li>웹사이트에서 변경한 내용이 Google Sheets에 반영되어야 한다.</li>\n<li>적용된 계산식은 Google Sheets에만 보여야 한다.</li>\n</ol>\n<p>많은 고민이 있었다. 어떻게 해야 Google Sheets를 내 프로젝트에 가져올 수 있을까? 그리고 그걸 DB에 연동할 수 있을까? 나는 비용을 발생시켜서도 안되고, 그렇다고 제대로 만들지 않을 수 없다. 내가 고민한 방법은 다음과 같다.</p>\n<ul>\n<li><strong>PI를 활용하기</strong> -> 비용이 나갈 수 있기에 후 순위에 두었다.</li>\n<li><strong>크롤링</strong> - 시트 열람하는데 있어서 권한 문제가 발생할 듯 하여 접었다.</li>\n<li><strong>아파치 POI</strong> -> url은 읽지 못하고 로컬 파일만 읽어서 접었다.</li>\n<li><strong>apps script</strong> -> DB연동하는데 있어서 결국 Google Cloud를 써야한다.</li>\n</ul>\n<p>그래서 내가 내린 결론은 바로 Google Sheets API다!!! 알아보니, 200만건 조회에 한해서 무료로 사용할 수 있다고 하여 선택했다. 그럼 지금부터 이게 도대체 무엇이고, 어떻게 활용할 수 있는지 정리해보겠다.</p>\n<h2 id=\"google-sheets-api\" style=\"position:relative;\"><a href=\"#google-sheets-api\" aria-label=\"google sheets api permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Google Sheets API</h2>\n<p>인터넷에 검색해보는 것보다 <a href=\"https://developers.google.com/sheets/api/guides/concepts?hl=ko\">공식문서</a>를 꼭 보면서 개발하면 좋다.(사실 인터넷에는 많은 정보가 없었다…)</p>\n<p>내가 가장 먼저 해야하는 일은 Google Sheets를 내 프로젝트에 가져오는 것이다. 나는 Java가 익숙하기 때문에 여러 언어 중 Java로 가져올 것이다. 그 전에 먼저 설정할 것들이 있다.</p>\n<h3 id=\"준비\" style=\"position:relative;\"><a href=\"#%EC%A4%80%EB%B9%84\" aria-label=\"준비 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>준비</h3>\n<ol>\n<li>Google Cloud 콘솔 접속</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACF0lEQVQ4y3VT225SQRTlP9QXgb7YHusDYNTEB/XNxD/yC4zv/oiRAgUUL/HJ2KjBqHiJCU0PlB7mzHXPLLPnwClt4yQrs2df1r7MTOXBnUe4f+shbt+4h51aC9vVRkRSb2Gn1kRSb2K72sS1q40C1Qa2ruyidilB/XKy2q9jd6uFm8ldVHp7A+y96KHb7mO/M4jod4dx77SH6HZeYzR8i9HwTYmX/REGvQLD/VfotPt4/OQ5nj7rohKCBy/vPayzWC8iB+sc/rfChswMC+EwP1FMGM44eiIQeYSYwCPLKcqsIyI456C1iTptNcazCRxRjNVKosJCns1xdJRiOpuDzlVBnD44BF9Ua62FEPmqMo+/Ygq/6lIpVRCK5Qmmh4fIvnyE+fUDmQ6Qs2OEbIHgAwLJiJgkBFhHEKqANoBfNXlKqAxm0xRu8g02W0CKHP7rJ2B8AKfVacWr8Wgb8O7Dd7w/+InPkxTWhU3CEBXaAYaVjtsMUZYBcBSgDFdC8H5N6DH+fRzxJ3UwZwmBXGoIIWGMQy4tnPMwhqCUje0Z62EsxZcQZxcKUk6krIcP5wiXywxpmpYBPHit1cbZxNtdXxTbWefj7YZyFCUhOxtjiufC2bWBlLIkYZnt6zmynOc5tNbxfIFQKRmrZAdeHCCEKCtkwizLygQcyHYmZZ8LhNYSpOK2qPw1HLzO7n3xqDfPbN/0KX4X4R+yfb1koGJnRwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1\"\n        title=\"1\"\n        src=\"/static/b5280eb09132214b057f6665fab12c64/37523/1.png\"\n        srcset=\"/static/b5280eb09132214b057f6665fab12c64/e9ff0/1.png 180w,\n/static/b5280eb09132214b057f6665fab12c64/f21e7/1.png 360w,\n/static/b5280eb09132214b057f6665fab12c64/37523/1.png 720w,\n/static/b5280eb09132214b057f6665fab12c64/302a4/1.png 1080w,\n/static/b5280eb09132214b057f6665fab12c64/07a9c/1.png 1440w,\n/static/b5280eb09132214b057f6665fab12c64/d9ed5/1.png 2880w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ol start=\"2\">\n<li>프로젝트 생성</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACaUlEQVQ4y42R204TURSG+yIYb6R6I0VvwEPiDfHKxAfw1njnE4hAD5xMDEYSDBAKbadznhJ8AN+AEMOhlCtFKAVmaKHSaTvTz8zmIKBEV/Jl7b32Xn/WIfT08XN6Hj7j0b0eOtq7uHurS/jO2w+IhLvpDHcLH8TOuHPzPuEbnbS3RQThtgiRcBddHU8IDcVGiA8MkogOMxgfIfo2LujvjdH3JkZfb/A2RHzgN7H+BNG+BEOJdwwnRolHh3nxMsar10OEdF3DMA00TUPVVBaXllheXWFtbZXllRXW8nkKGwUKG+vCrxfWWcsXWFz6imHl+LywgG4ZpCSV2VSWkGEYmKaFaRjk5udx90pQq/EvOzqqImUlxuc+oes6OctEUWRCpmWRlVLMJJNMp9JsFx0cp8Z+2cWu1LErDezDgCb2kSfu5arP9619FFVmOjvDSVEmsiwTsiwLScowMz2FNT5G2TnkuOnz87hGvd7A8/wTGg081xU+MNt2SGVkFNXEMMwLgqaJpGhkJqf4MjaKU9zG3trjx7ZNo1EXyX6ziZf+iJ8exzssi1iptMvw+wk+TMyi6iaWdSpoioWYyAG5BarVKs3SDrXjY5HYarUE/tY3WvYu/ukM9/ZtITY5q6NqxkVBk6yskJGyaKqG69bPBx8IXbWz2MHBARkpaNm40rKYocRsMim25bpukIXv++fVCXyPlu+LeGCO46DIshC6tJTgoOk6iqIIQc/z+B+rVCqikEDsD8HgkMlkhN/c3GRnZ4disXgtpVKJfD5POp3+u6Cq6ciKiqKq4tPc3BypVOpagvfgn6qqlwSDDn8B4Bk9aCZbPOEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2\"\n        title=\"2\"\n        src=\"/static/b55e9e49e62584f77108293e39d3bf50/37523/2.png\"\n        srcset=\"/static/b55e9e49e62584f77108293e39d3bf50/e9ff0/2.png 180w,\n/static/b55e9e49e62584f77108293e39d3bf50/f21e7/2.png 360w,\n/static/b55e9e49e62584f77108293e39d3bf50/37523/2.png 720w,\n/static/b55e9e49e62584f77108293e39d3bf50/302a4/2.png 1080w,\n/static/b55e9e49e62584f77108293e39d3bf50/07a9c/2.png 1440w,\n/static/b55e9e49e62584f77108293e39d3bf50/d9ed5/2.png 2880w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ol start=\"3\">\n<li>서비스 계정 생성</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACCklEQVQ4y62Sy05UQRCGz3voSsGNgiyMKBsXuDO+kk9g3PsiRhiYYQh30ERMjCsFTWBgznX63Pp2PtM9cwbMuLSTL11dSf39d1UHL1des/r8FStLqyzMLbMw99Tz6P54f3jvCXN3FmeYv7vI/DR+zNKDZZ4tviDodvp0PnbZXO/R2+hP6XZ6bKz16azv0O/usN0b42LH1uYOW5N8Z63Hm7cfePd+g0BJSQMYaynLEmM0biltqKXGNg3/WrezFkhzTSokwfD6GiEEShnCMCSOYrKRIExyRqKkKHJEUZFkBXlRY4xBa+P3Fmvs5ApLEGcVZW3QpqHMBcPhkOHlBYPznyRJ7F3nuaAqS5RSVFXlcfkbKjJRoZQmiBJBWWuUaShygdYKEYUMzn4QRxFJkhDHMULkSCk9WusZpNLebVDkOdYab9kVp2lKXhTESUIURRRFQV3X3pUrLCdOXdw+eSyqxoLTJjeNd3I1GDDKMqwx3o0Ta4tuC1lrp893sRumF3RCzUSwdL1RCmkszrO2DcraScGNm1awvcQYi1TG/xQv6EffNFxfXSEufmPiEBmFqCRGpTG6rmd65oRcO9pzOqooK0ngRu7w/3CUIb8cIT8fUJ9+ovp2ivz+FS1GaGNnByGld+pMSVn79gT85xUc7h1zuH/Cwd6x53D36G9crmX/xLO7fcD52a/pMG/zByJBsYdc0kA2AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"3\"\n        title=\"3\"\n        src=\"/static/0310071cc99acd127c7b03760b100af4/37523/3.png\"\n        srcset=\"/static/0310071cc99acd127c7b03760b100af4/e9ff0/3.png 180w,\n/static/0310071cc99acd127c7b03760b100af4/f21e7/3.png 360w,\n/static/0310071cc99acd127c7b03760b100af4/37523/3.png 720w,\n/static/0310071cc99acd127c7b03760b100af4/302a4/3.png 1080w,\n/static/0310071cc99acd127c7b03760b100af4/07a9c/3.png 1440w,\n/static/0310071cc99acd127c7b03760b100af4/d9ed5/3.png 2880w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ol start=\"4\">\n<li>서비스 계정 키 발급</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB8klEQVQ4y5WSy05TURSG93vowFgwMUAlJhSDAwfqzPhIPoFx7osYa2tLSW8qysC5aINCKM257Pv1N3sfSlo6IKzky7rsnb3O+s8iL5++xou9V9jbfo6ttV1s1hrYrO1ga62RqK83Um2jtpPqG/cr//DeY6zdqSfW7z7C9oNdPKk/A+m2emh97KDd7KLT6lW0e+h82ker2UO7NUC/N1zhoDvA/uc+Drp9tJpdvHn7Ae/et0G0knDew4cApTV88IjmvIOxFlW2amEhdgByZpFTDTK9yKCUhpAaRUmhlII2HlobOOfgY7NFUm25Hny4akNOpzx1U1KCcwbOBSjjKCkFpRRCiATnHEJKCGnAhbqqS1l5xhistSB5nkNpC2M0stkUkz+/cXLyF8fHvzCZTFDkOYqiQLyXFyWyUiArWJXnObIsS+fRa61BTs9zZNSn5GwmcJHxxCyjsM7htkbOZxQFU6BcgjIJHb9WSFil4Y2BlwLO6KTnXNP4E+f5IiEEEMZoJbRzYJyhpAXsz0PYoxHM0RjmxxD87B+4UhCcJy3jNFGvRUxs7j2Iuxwrvj4HcXWsBayJB8vrci1fGTmKKaWCc35pJO8DnA+Xq1Ixf2yx+XVIQLiV6Dc9SsaDb/gyOkT042EVR76OvlfxMFKdFUV549j/AUoPtoozuKY1AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4\"\n        title=\"4\"\n        src=\"/static/29288257768fb9f63c0bf310edb0c529/37523/4.png\"\n        srcset=\"/static/29288257768fb9f63c0bf310edb0c529/e9ff0/4.png 180w,\n/static/29288257768fb9f63c0bf310edb0c529/f21e7/4.png 360w,\n/static/29288257768fb9f63c0bf310edb0c529/37523/4.png 720w,\n/static/29288257768fb9f63c0bf310edb0c529/302a4/4.png 1080w,\n/static/29288257768fb9f63c0bf310edb0c529/07a9c/4.png 1440w,\n/static/29288257768fb9f63c0bf310edb0c529/d9ed5/4.png 2880w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ol start=\"5\">\n<li>스프레드 시트 생성 및 공유</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACQUlEQVQ4y5WTzUsbQRjG9y+ph4KNIPXjYFUEaQUvjR/RRE1tdnd2djeJ4KEeU9EotiIWg1IoPfZv6L2XQi+lxxLTgBQaqaDpR2ytbj5+ZdbEhlLBDjzzzLzzzjPvDM9ofZ1D9LQPcqv7NsODYwwPjDHUF6S7bYCO1l5utvbSGein/XoPN651EWjpJtDS4HO0tXTRFeint+MO2uT4FKHRMJPj04RGI6i5wkxklujU/TrHfJ6ajF4gMjHDxFiEcGiauyPTjIRm/RzNEBaGEAhLIqTtsykszCZWOWospPTXLdvBkvZ5zJLopoUupB/TZu6ZGKZACIFlWdi2jeM4JBKJOpLE4wlc18V14/5Y5Uhp++xDSpx6TFOdrC84rouh62xsbJDPfyC3u0s2myWfz1MoFNjfL5DL5UilUn4B6hB1eDM0t2kSj8eJxWLs7Oxw6nmceB6VSoVarUajeZ5HOp3GNM1/Czp/Cep6jK1MhuLBZw738hSPDvHKZarVKlCjXPZYXl6+mqBK0GMxtra3+bKX5+zdG85+HFOpVqlWKnjlCie/Tv9TUNfZfLJJ4eiA/cMiR8UipVKJ0vExr99/5OXbHKmHiwhxxSurN8xkMpyclvn29Tvr6495sLDA82dPyX76yYtXB6TTV6xQQUrJ/Pw8a2uPWFlZJRwOEwwGiUajrKyusbi0ytzc3IW9LhVseKohquxjGIbvxWQy6VdvmgZCGJeKOY6Nptw+q1tY6gfUoQR989r2RexcxPVh238KaIba9xuv72kYIQ+pqQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"5\"\n        title=\"5\"\n        src=\"/static/4dd1eac87d53b1945a0a6da5a0c47f11/37523/5.png\"\n        srcset=\"/static/4dd1eac87d53b1945a0a6da5a0c47f11/e9ff0/5.png 180w,\n/static/4dd1eac87d53b1945a0a6da5a0c47f11/f21e7/5.png 360w,\n/static/4dd1eac87d53b1945a0a6da5a0c47f11/37523/5.png 720w,\n/static/4dd1eac87d53b1945a0a6da5a0c47f11/302a4/5.png 1080w,\n/static/4dd1eac87d53b1945a0a6da5a0c47f11/07a9c/5.png 1440w,\n/static/4dd1eac87d53b1945a0a6da5a0c47f11/d9ed5/5.png 2880w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>더 이상 자세한 말은 생략하겠다.^.^</p>\n<h3 id=\"java-코드-작성\" style=\"position:relative;\"><a href=\"#java-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1\" aria-label=\"java 코드 작성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Java 코드 작성</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">APPLICATION_NAME</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"아무거나 하면 된다.\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">JsonFactory</span> <span class=\"token constant\">JSON_FACTORY</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">JacksonFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">getDefaultInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">SPREADSHEET_ID</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"스프레드 시트 ID - ID 확인 방법은 공식문서에...\"</span>\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">CREDENTIALS_FILE_PATH</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"json 파일을 프로젝트에 저장해두고 그 경로를 적자\"</span>\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> <span class=\"token constant\">SCOPES</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">Collections</span><span class=\"token punctuation\">.</span><span class=\"token function\">singletonList</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SheetsScopes</span><span class=\"token punctuation\">.</span><span class=\"token constant\">SPREADSHEETS</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">RANGE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"가져올 범위(A1:B2)\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">Credential</span> <span class=\"token function\">getCredentials</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">ClassLoader</span> loader <span class=\"token operator\">=</span> 현재클래스<span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">.</span><span class=\"token function\">getClassLoader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">GoogleCredential</span> credential <span class=\"token operator\">=</span> <span class=\"token class-name\">GoogleCredential</span><span class=\"token punctuation\">.</span><span class=\"token function\">fromStream</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">FileInputStream</span><span class=\"token punctuation\">(</span>loader<span class=\"token punctuation\">.</span><span class=\"token function\">getResource</span><span class=\"token punctuation\">(</span><span class=\"token constant\">CREDENTIALS_FILE_PATH</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getFile</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">createScoped</span><span class=\"token punctuation\">(</span><span class=\"token constant\">SCOPES</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> credential<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">List</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> <span class=\"token function\">getData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">GeneralSecurityException</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">final</span> <span class=\"token class-name\">NetHttpTransport</span> <span class=\"token constant\">HTTP_TRANSPORT</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">GoogleNetHttpTransport</span><span class=\"token punctuation\">.</span><span class=\"token function\">newTrustedTransport</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Sheets</span> service <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Sheets<span class=\"token punctuation\">.</span>Builder</span><span class=\"token punctuation\">(</span><span class=\"token constant\">HTTP_TRANSPORT</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">JSON_FACTORY</span><span class=\"token punctuation\">,</span> <span class=\"token function\">getCredentials</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">setApplicationName</span><span class=\"token punctuation\">(</span><span class=\"token constant\">APPLICATION_NAME</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">ValueRange</span> response <span class=\"token operator\">=</span> service<span class=\"token punctuation\">.</span><span class=\"token function\">spreadsheets</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">values</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token constant\">SPREADSHEET_ID</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">RANGE</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">excute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">getValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이걸로 나는 구글 스프레드 시트와 연결되어 원하는 범위의 내용을 가져올 수 있게 되었다!!!<br>\n우리 회사 코드에 맞게 조리있게 사용할 수 있다. ValueRange로 return 해주는데, <code class=\"language-text\">List&lt;List&lt;Object>></code>타입이다. 우리 회사에 맞게 타입을 변경하여 데이터를 넣어주고, 이를 활용하여 DB에서 SELECT, INSERT, UPDATE, DELETE할 수 있다. 간단하게 RUD를 할 수 있게 되었다. 물론 스프레드 시트를 만들수도 있지만, 이미 있는 시트를 활용해야 했기에 그 기능은 빼고 개발했다.</p>\n<h2 id=\"늘어가는-고민\" style=\"position:relative;\"><a href=\"#%EB%8A%98%EC%96%B4%EA%B0%80%EB%8A%94-%EA%B3%A0%EB%AF%BC\" aria-label=\"늘어가는 고민 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>늘어가는 고민</h2>\n<p>나는 스프레드 시트 데이터를 가져오는 것을 <strong>Service</strong>에<br>\nSELECT, INSERT, UPDATE, DELETE하는 것을 Service를 호출하여 <strong>Controller</strong>에서 수행한다.<br>\n이러한 구조가 맞는지 고민이 된다…<br>\n정리해보면 service - controller - service - dao - xml 이런 연결 관계다.</p>\n<h2 id=\"느낀점\" style=\"position:relative;\"><a href=\"#%EB%8A%90%EB%82%80%EC%A0%90\" aria-label=\"느낀점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>느낀점</h2>\n<p>현업의 불편함을 해소하고 능률적인 업무를 진행하기 위해 개발했다. 평소에 하던 개발과 조금은 다르고, 인터넷 정보가 많지 않아서 어려움이 있었다. 또한 아직 신입이기에 어떻게 구성할 것인지, 뭐가 더 좋은 구조인지, 어떤게 더 좋은 방법인지 많은 고민을 했었던 것 같다. 이러한 고민을 통해 나는 한 단계 더 성장했을 것이다.</p>\n<h3 id=\"참고\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0\" aria-label=\"참고 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고</h3>\n<p><a href=\"https://many.tistory.com/11\">Google SpreadSheet API와 JAVA 연동하기 #1</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#intro\">Intro</a></p>\n</li>\n<li>\n<p><a href=\"#google-sheets-api\">Google Sheets API</a></p>\n<ul>\n<li><a href=\"#%EC%A4%80%EB%B9%84\">준비</a></li>\n<li><a href=\"#java-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1\">Java 코드 작성</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%8A%98%EC%96%B4%EA%B0%80%EB%8A%94-%EA%B3%A0%EB%AF%BC\">늘어가는 고민</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%8A%90%EB%82%80%EC%A0%90\">느낀점</a></p>\n<ul>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0\">참고</a></li>\n</ul>\n</li>\n</ul>\n</div>","excerpt":"Intro 회사에서 수습사원을 떼고, 첫 업무가 주어졌다!!! 유관부서에서 Google Sheets로 대시보드처럼 사용하고 있었는데, Google Sheets에서 편집한게 우리가 사용하는 웹 사이트에도 보였으면 좋겠다는 요구였다. 정리해보자! Google Sheets가 DB에 연동이 되어야한다. Google Sheets에서 계산식이 자동으로 적용되어야 한다. Google Sheets에서 변경된 내용은 웹사이트에도 반영되어야 한다. 웹사이트에서 변경한 내용이 Google Sheets에 반영되어야 한다. 적용된 계산식은 Google Sheets에만 보여야 한다. 많은 고민이 있었다. 어떻게 해야 Google Sheets를 내 프로젝트에 가져올 수 있을까? 그리고 그걸 DB에 연동할 수 있을까? 나는 비용을 발생시켜서도 안되고, 그렇다고 제대로 만들지 않을 수 없다. 내가 고민한 방법은 다음과 같다. PI를 활용하기 -> 비용이 나갈 수 있기에 후 순위에 두었다. 크롤링 - 시트 열람하…","frontmatter":{"date":"May 22, 2024","title":"Google Sheets API","categories":"Google_Sheets","author":"신승민","emoji":"🍋"},"fields":{"slug":"/Google Sheets API/"}},"next":{"id":"2cbc5046-2440-56be-8f61-8d087d6d0ff5","html":"<h2 id=\"앞서서\" style=\"position:relative;\"><a href=\"#%EC%95%9E%EC%84%9C%EC%84%9C\" aria-label=\"앞서서 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>앞서서</h2>\n<p>저희 회사에서 api 개발하는 것을 보며, 저도 언젠가 저렇게 멋진 API를 만들겠다고 다짐했습니다. 그러기 위해서 RESTful API에 대해서 공부를 시작했습니다. 먼저 API 명세서를 작성하는 방법에 대해서 알아보았습니다. 찾아본 여러 방법 중에서 가장 자료가 많았던 것은 <strong>Swagger</strong>와 <strong>Spring REST Docs</strong>입니다. 둘이 어떻게 다르고 어떤 특징이 있는지 알아보겠습니다.</p>\n<blockquote>\n<p>그 전에! OAS가 뭔지는 알아야 합니다.\n블로그를 볼 때마다 나와서 찾아봐야 했거든요..</p>\n</blockquote>\n<h2 id=\"oasopen-api-specification\" style=\"position:relative;\"><a href=\"#oasopen-api-specification\" aria-label=\"oasopen api specification permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>OAS(Open API Specification)</h2>\n<p>OAS는 “개발자가 <strong>RESTful API</strong>를 쉽게 관리하고 사용할 수 있게 도와주는 표준 명세 작성 방식”이라고 이해하면 됩니다.<br>\nJSON, YAML 형식으로 작성된다는 것을 알고 다음 코드를 봅시다.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">openapi<span class=\"token operator\">:</span> <span class=\"token number\">3.0</span>.<span class=\"token number\">0</span>\ninfo<span class=\"token operator\">:</span>\n  title<span class=\"token operator\">:</span> Sample API\n  description<span class=\"token operator\">:</span> Optional multiline or single-line description in <span class=\"token punctuation\">[</span>CommonMark<span class=\"token punctuation\">]</span>(http<span class=\"token operator\">:</span><span class=\"token comment\">//commonmark.org/help/) or HTML.</span>\n  version<span class=\"token operator\">:</span> <span class=\"token number\">0.1</span>.<span class=\"token number\">9</span>\n\nservers<span class=\"token operator\">:</span>\n  - url<span class=\"token operator\">:</span> http<span class=\"token operator\">:</span><span class=\"token comment\">//api.example.com/v1</span>\n    description<span class=\"token operator\">:</span> Optional server description<span class=\"token punctuation\">,</span> e.g. Main (production) server\n  - url<span class=\"token operator\">:</span> http<span class=\"token operator\">:</span><span class=\"token comment\">//staging-api.example.com</span>\n    description<span class=\"token operator\">:</span> Optional server description<span class=\"token punctuation\">,</span> e.g. Internal staging server for testing\n\npaths<span class=\"token operator\">:</span>\n  /users<span class=\"token operator\">:</span>\n    get<span class=\"token operator\">:</span>\n      summary<span class=\"token operator\">:</span> Returns a list of users.\n      description<span class=\"token operator\">:</span> Optional extended description in CommonMark or HTML.\n      responses<span class=\"token operator\">:</span>\n        '<span class=\"token number\">200</span>'<span class=\"token operator\">:</span>    # status code\n          description<span class=\"token operator\">:</span> A JSON array of user names\n          content<span class=\"token operator\">:</span>\n            application/json<span class=\"token operator\">:</span>\n              schema<span class=\"token operator\">:</span>\n                type<span class=\"token operator\">:</span> array\n                items<span class=\"token operator\">:</span>\n                  type<span class=\"token operator\">:</span> string\n</code></pre></div>\n<p>자세한 형식은 <a href=\"https://swagger.io/resources/open-api/\">공식 문서</a>를 참고해주세요.</p>\n<h2 id=\"swagger\" style=\"position:relative;\"><a href=\"#swagger\" aria-label=\"swagger permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Swagger</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA5ElEQVQY02P4jwRevnt17/mdnz9+w0X+/fv3Hzdg+P///99/f////3/z0c2Wg5l1pyKWn5z78/ufp89f/P379/efPz9+/vzx48eXr9++ff/+4+fPnz9/oWj+9x+kefmpOXlbA9rOpOSvjXz29tmOPYfWbtmxfe+hjdv3rNu66+S5i8vXbV65YeuHj5/gLkLYfOz64Yr94c3Xwvr21P/4/vPew0e37j24fvvuxSvX127ZuWnnvqOnzz14/OTnz59wvzAgvPfn/4UHZ3df2fz241tk3/779+/z169fvn379fs3WigAAMTyDgPjnoT6AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"alt text\"\n        title=\"alt text\"\n        src=\"/static/9276a563a889ba3f2337ac2916a067d4/37523/image.png\"\n        srcset=\"/static/9276a563a889ba3f2337ac2916a067d4/e9ff0/image.png 180w,\n/static/9276a563a889ba3f2337ac2916a067d4/f21e7/image.png 360w,\n/static/9276a563a889ba3f2337ac2916a067d4/37523/image.png 720w,\n/static/9276a563a889ba3f2337ac2916a067d4/302a4/image.png 1080w,\n/static/9276a563a889ba3f2337ac2916a067d4/07a9c/image.png 1440w,\n/static/9276a563a889ba3f2337ac2916a067d4/541fe/image.png 1654w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\nSwagger는 Controller에 몇 가지의 어노테이션을 달기만 해도 API 문서가 만들어집니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@ApiOperation</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> notes <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@PostMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/home\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">home</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">\"home\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<p>어떄요? 쉽지 않나요?</p>\n</blockquote>\n<p>하지만… 이렇게 계속 소스코드에 작성하게 된다면 코드가 너무 지저분해지지는 않을까요…?</p>\n<p><img src=\"https://velog.velcdn.com/images/gimminjae/post/e990daf7-d3f8-41c6-a792-dfadfc70c057/image.png\" alt=\"\"></p>\n<p><a href=\"http://localhost:8080/swager-ui/%EB%A1%9C\">http://localhost:8080/swager-ui/로</a> 접속하게 되면 위와 같은 UI를 볼 수 있습니다.<br>\n또한 API 명세 확인 및 요청 테스트도 진행할 수 있습니다.</p>\n<p>그럼 정리해봅시다.</p>\n<p><strong>장점</strong></p>\n<ul>\n<li>깔끔한 UI</li>\n<li>어노테이션으로 편리한 작성법</li>\n<li>API Test 기능 지원</li>\n</ul>\n<p><strong>단점</strong></p>\n<ul>\n<li>더러워지는 소스코드</li>\n<li>API스펙과 일치 보장하지 않음</li>\n</ul>\n<h2 id=\"spring-rest-docs\" style=\"position:relative;\"><a href=\"#spring-rest-docs\" aria-label=\"spring rest docs permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Spring REST Docs</h2>\n<p><strong>테스트</strong> 기반으로 <strong>아스키닥(Asciidoc) 스니펫(snippet, 코드 조각; 재사용 가능한 소스 코드)</strong> 을 생성하고 이를 조합하여 <strong>아스키닥터(Asciidoctor)</strong> 플러그인을 이용해서 HTML 문서 생성</p>\n<p><img src=\"https://helloworld.kurly.com/post-img/spring-rest-docs-guide/06-spring-rest-docs-example.png\" alt=\"\"></p>\n<blockquote>\n<p><a href=\"https://github.com/thefarmersfront/spring-rest-docs-guide\">Spring REST Docs 가이드 예제</a></p>\n</blockquote>\n<ul>\n<li>build.gradel : asciidcotor 플러그인 및 asciidoctor 태스크 관련 스크립트 확인</li>\n<li>OrderRestControllerDocTest : 스테펫을 생성하기 위한 테스트 코드</li>\n<li>index.adoc : API 문서 생성시 기준이 되는 최상위 아스키닥(asciidoc) 문서입니다.</li>\n<li>사용자 정의 스니펫 : “Spring REST Docs”에서 제공하느 ㄴ스니펫 형식을 구미에 맞게 변경</li>\n</ul>\n<p>또 다른 방법으로는 Spring REST Docs로 OAS 문서를 만들어 Swagger UI로 호출하는 것입니다. 다시 말하자면, “Spring REST Docs API Specification Integration”을 이용하면 OAS문서를 JSON 혹은 YAML 형식으로 생성할 수 있습니다.</p>\n<blockquote>\n<p>OAS 문서 Swagger-UI, Postman 등 다양하게 활용 가능!</p>\n</blockquote>\n<p>그럼 정리해봅시다.</p>\n<p><strong>장점</strong></p>\n<ul>\n<li>테스트를 통해 스니펫을 생성함으로써, API에 대한 신뢰감 제공</li>\n<li>코드 변경에 대해 즉각적인 확인이 가능하다.</li>\n</ul>\n<p><strong>단점</strong></p>\n<ul>\n<li>\n<p>준비해야할 것이 많다(Spring Web, Test Framework, Spring REST Docs 작성, asciidoc, gradle…)</p>\n</li>\n<li>\n<p>개발자의 노력 정도에 따라 품질 편차가 심하다.</p>\n</li>\n</ul>\n<p><strong>결론</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">코드에 문서화를 위해 어노테이션이 붙게 되면 복잡하게 보일 수 있겠지만,  \n내가 생각했을 때에는 문서화마저도 코드로 작성할 수 있다는 것은 큰 이점이라고 판단이 된다.  \n여러 작업을 통해 하지 않고, 하나의 작업으로 여러 작업을 해결할 수 있기 때문이다.  \n그래서 나는 Spring REST Docs보다 Swagger 활용이 더 효율적이라고 생각한다.</code></pre></div>\n<h3 id=\"참고\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0\" aria-label=\"참고 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고</h3>\n<p><a href=\"https://docs.tosspayments.com/resources/glossary/oas\">TossPayments-개발자센터</a><br>\n<a href=\"https://tech.kakaopay.com/post/openapi-documentation/\">kakaopay tech</a><br>\n<a href=\"https://velog.io/@gimminjae/Swagger-UI%EB%9E%80-%EC%99%9C-%EC%82%AC%EC%9A%A9%ED%95%B4%EC%95%BC-%ED%95%A0%EA%B9%8C\">Swagger-UI란? 왜 사용해야 할까?</a><br>\n<a href=\"https://helloworld.kurly.com/blog/spring-rest-docs-guide/?gad_source=1&#x26;gclid=CjwKCAjw9IayBhBJEiwAVuc3fvKMFcJfnfd-4aiqlmgUVHp3k6fUoi2BGJCjj4nVJ6phAI4EILieUxoCorYQAvD_BwE\">내가 만든 API를 널리 알리기 - Spring REST Docs 가이드편</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EC%95%9E%EC%84%9C%EC%84%9C\">앞서서</a></p>\n</li>\n<li>\n<p><a href=\"#oasopen-api-specification\">OAS(Open API Specification)</a></p>\n</li>\n<li>\n<p><a href=\"#swagger\">Swagger</a></p>\n</li>\n<li>\n<p><a href=\"#spring-rest-docs\">Spring REST Docs</a></p>\n<ul>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0\">참고</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"May 16, 2024","title":"Swagger vs Spring REST Docs","categories":"API","author":"신승민","emoji":"🍲🍚"},"fields":{"slug":"/Swagger vs Spring REST Docs/"}},"prev":{"id":"49e0c55a-5127-5e20-a0ea-923d165971a9","html":"<h2 id=\"intro\" style=\"position:relative;\"><a href=\"#intro\" aria-label=\"intro permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Intro</h2>\n<p>저번 Google Sheets API에 이어서, 이번엔 Google Apps Script이다.<br>\n난 시트 내에서 계산식이 자동으로 다음줄에도 계산이 되어야한다는 요구사항을 받았다.<br>\n그래서 여러 방법을 고민하기 시작했다…</p>\n<ol>\n<li><strong>Google Sheets</strong> 내의 함수나 기능 활용하기</li>\n<li><strong>Java/Javascript</strong> 로 가져와서 계산식을 적용하고 다시 뿌려주기</li>\n<li><strong>Apps Script</strong> 활용하기</li>\n</ol>\n<p>1번은 찾지 못했다. 2번은 작성해야 하는 코드가 많아서 번거로웠다. 그래서 나는 3번인 Apps Script를 활용하기로 결정했다.<br>\n<strong>앱 스크립트(App Script)</strong> 는 구글 워크스페이스 플랫폼에서 가벼운 애플리케이션 개발을 위해 구글이 개발한 스크립팅 플랫폼이다.<br>\n난 이걸 활용하여 자동으로 계산식에 이어서 계산이 되는 기능을 구현하고자 한다.</p>\n<p>하지만 난 Apps Script가 처음이기 때문에 어떻게 접근해야할 지 몰랐다.<br>\n그러다 팀장님이 귀뜸해주신 말씀에 도움을 얻어서 매크로를 활용했다.<br>\n매크로를 기록하고 관리 페이지에서 스크립트 수정이 가능하다.  이걸로 관련 함수와 구현 방법에 대해 익숙해질 수 있었다.</p>\n<h2 id=\"구현-로직\" style=\"position:relative;\"><a href=\"#%EA%B5%AC%ED%98%84-%EB%A1%9C%EC%A7%81\" aria-label=\"구현 로직 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>구현 로직</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">스프레드 시트 연결 -> 특정 범위 지정 -> 비어 있지 않은 셀 찾기 -> 마지막 셀 찾기 -> 연산 수행</code></pre></div>\n<h3 id=\"1-스프레드-시트-연결\" style=\"position:relative;\"><a href=\"#1-%EC%8A%A4%ED%94%84%EB%A0%88%EB%93%9C-%EC%8B%9C%ED%8A%B8-%EC%97%B0%EA%B2%B0\" aria-label=\"1 스프레드 시트 연결 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1) 스프레드 시트 연결</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> spreadsheet <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActive</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </code></pre></div>\n<p>가장 먼저 스프레드 시트와 연결을 해야하는데 확장 프로그램이다 보니, <code class=\"language-text\">Google Sheets API</code>처럼 복잡한 코드가 아니다.</p>\n<h3 id=\"2-특정-범위-지정\" style=\"position:relative;\"><a href=\"#2-%ED%8A%B9%EC%A0%95-%EB%B2%94%EC%9C%84-%EC%A7%80%EC%A0%95\" aria-label=\"2 특정 범위 지정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2) 특정 범위 지정</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> range <span class=\"token operator\">=</span> spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token string\">'범위(B2:C3)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  \n<span class=\"token keyword\">var</span> numRows <span class=\"token operator\">=</span> range<span class=\"token punctuation\">.</span><span class=\"token function\">getNumRows</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> numCols <span class=\"token operator\">=</span> range<span class=\"token punctuation\">.</span><span class=\"token function\">getNumColumns</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>범위를 지정해야 기준이 생긴다.</p>\n<blockquote>\n<p>그렇다면 범위는 무작정 작게 하는게 좋을까? 무작정 크게 늘려 놓는게 좋을까?</p>\n</blockquote>\n<h3 id=\"3-비어-있지-않은-셀-찾기\" style=\"position:relative;\"><a href=\"#3-%EB%B9%84%EC%96%B4-%EC%9E%88%EC%A7%80-%EC%95%8A%EC%9D%80-%EC%85%80-%EC%B0%BE%EA%B8%B0\" aria-label=\"3 비어 있지 않은 셀 찾기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3) 비어 있지 않은 셀 찾기</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> nonEmptyCells <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  \n<span class=\"token comment\">// 지정한 범위 내에서 비어 있지 않은 셀을 찾아 nonEmptyCells 배열에 추가</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> row <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> row <span class=\"token operator\">&lt;=</span> numRows<span class=\"token punctuation\">;</span> row<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> col <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> col <span class=\"token operator\">&lt;=</span> numCols<span class=\"token punctuation\">;</span> col<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> cellValue <span class=\"token operator\">=</span> range<span class=\"token punctuation\">.</span><span class=\"token function\">getCell</span><span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cellValue <span class=\"token operator\">!==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            nonEmptyCells<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">row</span><span class=\"token operator\">:</span> row<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">column</span><span class=\"token operator\">:</span> col<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>값이 있다면 어떤 값이 어느 위치에 있는지 배열에 담아두는 것이다.</p>\n<blockquote>\n<p>그러다 빈 값이 나오겠지?</p>\n</blockquote>\n<h3 id=\"4-마지막-셀-찾기\" style=\"position:relative;\"><a href=\"#4-%EB%A7%88%EC%A7%80%EB%A7%89-%EC%85%80-%EC%B0%BE%EA%B8%B0\" aria-label=\"4 마지막 셀 찾기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4) 마지막 셀 찾기</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>nonEmptyCells<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> firstCell <span class=\"token operator\">=</span> nonEmptyCells<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> lastCell <span class=\"token operator\">=</span> nonEmptyCells<span class=\"token punctuation\">[</span>nonEmptyCells<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"비어 있지 않은 셀의 범위: \"</span> <span class=\"token operator\">+</span> range<span class=\"token punctuation\">.</span><span class=\"token function\">getCell</span><span class=\"token punctuation\">(</span>firstCell<span class=\"token punctuation\">.</span>row<span class=\"token punctuation\">,</span> firstCell<span class=\"token punctuation\">.</span>column<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getA1Notation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\" - \"</span> <span class=\"token operator\">+</span> range<span class=\"token punctuation\">.</span><span class=\"token function\">getCell</span><span class=\"token punctuation\">(</span>lastCell<span class=\"token punctuation\">.</span>row<span class=\"token punctuation\">,</span> lastCell<span class=\"token punctuation\">.</span>column<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getA1Notation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    \n    \n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> lastRangeCell <span class=\"token operator\">=</span> range<span class=\"token punctuation\">.</span><span class=\"token function\">getCell</span><span class=\"token punctuation\">(</span>lastCell<span class=\"token punctuation\">.</span>row<span class=\"token punctuation\">,</span> lastCell<span class=\"token punctuation\">.</span>column <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getA1Notation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">var</span> inputRange <span class=\"token operator\">=</span> <span class=\"token string\">'G3:'</span> <span class=\"token operator\">+</span> lastRangeCell<span class=\"token punctuation\">;</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"가장 마지막 셀 : \"</span> <span class=\"token operator\">+</span> lastRangeCell<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        \n        <span class=\"token operator\">...</span>\n\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">...</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>거기가 마지막 셀, 하지만 그 다음줄에 또 이어지면 계속 빈 값을 무시하고 이어진다.</p>\n<h3 id=\"5-연산-수행\" style=\"position:relative;\"><a href=\"#5-%EC%97%B0%EC%82%B0-%EC%88%98%ED%96%89\" aria-label=\"5 연산 수행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5) 연산 수행</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> currentCell <span class=\"token operator\">=</span> spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getCurrentCell</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>        \n<span class=\"token keyword\">var</span> nowColumn <span class=\"token operator\">=</span> currentCell<span class=\"token punctuation\">.</span><span class=\"token function\">getColumn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> currentCellAlpha <span class=\"token operator\">=</span> currentCell<span class=\"token punctuation\">.</span><span class=\"token function\">getA1Notation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>nowColumn <span class=\"token operator\">==</span> <span class=\"token number\">6</span> <span class=\"token operator\">&amp;&amp;</span> currentCell<span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token string\">'수식이 있는 셀(D2)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">activate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveRange</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">autoFill</span><span class=\"token punctuation\">(</span>spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>inputRange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> SpreadsheetApp<span class=\"token punctuation\">.</span>AutoFillSeries<span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT_SERIES</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   \n    spreadsheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>currentCellAlpha<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">activate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"현재 선택한 셀 : \"</span> <span class=\"token operator\">+</span> currentCellAlpha<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>다 찾았으면 autoFill()을 활용하여 수식을 채워넣는다.</p>\n<h2 id=\"트리거\" style=\"position:relative;\"><a href=\"#%ED%8A%B8%EB%A6%AC%EA%B1%B0\" aria-label=\"트리거 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>트리거</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABNklEQVQoz51SPU/EMAzNvwfxT05igpGRBRZYQEwMMCB0atK0zUeTNnno+Y67gysIYcmKYzvPT89RRr+jtRbDMCDGCK0NjGnRdR1qrUdeSgVQcf0w4uy8R9NNKFOCDxHr9RrKuwF93wvgPM8COo4jUkqLgHQCvukJ988JYZzh/QBrO9jWQuWcUUoREJ7/Mb4jGZoaXEQIURiSKRlyCBkyDiHAe7/L0Tnch4AxZanTWWdemb7AOS/JpmmgjUHbtgLGIdRSay3aMmYvQZtGS51urd0NUs65rS7Yir6nv1tErZJj7bOX8eYOzIU9kFjlPB2Ivbfv96XaUos6ZPJ1k/hlyxDWNG774ibg8jbi8SVDLTH5Cej4PwJPrwknK4PTlcHVndswpJgUnCe1qvVvoDO/W3RAjfI36R8ZHw11SVDoMgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/b3f3c77072f58cc97eab4212ae35ff26/37523/image.png\"\n        srcset=\"/static/b3f3c77072f58cc97eab4212ae35ff26/e9ff0/image.png 180w,\n/static/b3f3c77072f58cc97eab4212ae35ff26/f21e7/image.png 360w,\n/static/b3f3c77072f58cc97eab4212ae35ff26/37523/image.png 720w,\n/static/b3f3c77072f58cc97eab4212ae35ff26/302a4/image.png 1080w,\n/static/b3f3c77072f58cc97eab4212ae35ff26/07a9c/image.png 1440w,\n/static/b3f3c77072f58cc97eab4212ae35ff26/ec09f/image.png 1916w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>위에서 코드를 다 작성했다면, 자동으로 코드가 실행되어야 하기 때문에 <strong>트리거</strong> 를 사용한다.<br>\n사진에서 보이는 것과 같이 트리거를 추가할 수 있고,<br>\n어떤걸 배포하고 어떤 이벤트에서 실행되며 어떤 함수를 실행시킬 것인지 모두 설정할 수 있다.</p>\n<blockquote>\n<p>저렇게 오류율이 조금 발생한 것은 내가 try-catch문에서 catch를 해주지 않았기 때문이다…</p>\n</blockquote>\n<p>저렇게 설정해두면, 스프레드를 수정하고 자동으로 저장이 될 때 수정이 된 시점으로 인식하여 트리거가 작동하게 된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABYElEQVQoz3VSQW7EIAzk4f1N+48+pofuNgkECMQQyKzGW1bpoZYsZGOPxwNmXmbEuGHfd6zrimWxcM6h1gO08zzVr5YEeHsP+PjcgbNBSsWyLFidhYkhIISI3jtKKRApejK+gh3HoYO3bYMPEV+3iPuSkFJCzhu+Z4ELFYaNIqIN/xkxWcea4UBTdq019N4g9cTRAMMJnBpj1LXJjnHOWafTa62aLyI6nHW7CFLKGtNLEb03XINrp5wxTZM2eh8UiEOojbUWIQQFZjNzPOd5VvAxkKfJu/yu3ODcqppdiwjEx2KO1vupOUrAeq48ZKEZFnJFNt/udy1gLLpSwjTNypxsabznT+D5M00v7ccDGgJRL34T65xOZvx8cYH3Xpkw92TYEWJUQGudAg6wFyBZ8oKatNaVGb9PzrvqR0ZkPRhSYzYPAn8YUisy4IsRnEkW9XFefDS13rWe2voQdAidgA9GfwqnzX3OMAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image 1\"\n        title=\"image 1\"\n        src=\"/static/1dc13fd4d41644245b98bbd8dc6bd96d/37523/image-1.png\"\n        srcset=\"/static/1dc13fd4d41644245b98bbd8dc6bd96d/e9ff0/image-1.png 180w,\n/static/1dc13fd4d41644245b98bbd8dc6bd96d/f21e7/image-1.png 360w,\n/static/1dc13fd4d41644245b98bbd8dc6bd96d/37523/image-1.png 720w,\n/static/1dc13fd4d41644245b98bbd8dc6bd96d/302a4/image-1.png 1080w,\n/static/1dc13fd4d41644245b98bbd8dc6bd96d/07a9c/image-1.png 1440w,\n/static/1dc13fd4d41644245b98bbd8dc6bd96d/460fa/image-1.png 1910w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n이렇게 실행된 결과도 힌 눈에 볼 수 있다.</p>\n<h2 id=\"나의-소감\" style=\"position:relative;\"><a href=\"#%EB%82%98%EC%9D%98-%EC%86%8C%EA%B0%90\" aria-label=\"나의 소감 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>나의 소감</h2>\n<p><strong>Google Sheets API</strong> 에 이어서 <strong>Apps Scripts</strong> 까지 해보니, 현업에서 고민되었던 문제를 해결할 수 있다는 사실에 벅찼다.<br>\n새로운 것들이었기 때문에 하나하나 알아가는 과정이 지루하지 않고 재밌었다.<br>\n다만 아직 <strong>Apps Script</strong> 에서 javascript에 익숙하지 않아서 클린코드, 객체지향적인 코드 작성을 했다고 말할 수는 없지만,<br>\n그래도 그걸 적용하고 나름대로 추출해보는 경험이 즐거웠다.<br>\n<strong>Apps Script</strong> 도 하나의 문제 해결 방법으로 고려해볼만 한 것 같다.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#intro\">Intro</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B5%AC%ED%98%84-%EB%A1%9C%EC%A7%81\">구현 로직</a></p>\n<ul>\n<li><a href=\"#1-%EC%8A%A4%ED%94%84%EB%A0%88%EB%93%9C-%EC%8B%9C%ED%8A%B8-%EC%97%B0%EA%B2%B0\">1) 스프레드 시트 연결</a></li>\n<li><a href=\"#2-%ED%8A%B9%EC%A0%95-%EB%B2%94%EC%9C%84-%EC%A7%80%EC%A0%95\">2) 특정 범위 지정</a></li>\n<li><a href=\"#3-%EB%B9%84%EC%96%B4-%EC%9E%88%EC%A7%80-%EC%95%8A%EC%9D%80-%EC%85%80-%EC%B0%BE%EA%B8%B0\">3) 비어 있지 않은 셀 찾기</a></li>\n<li><a href=\"#4-%EB%A7%88%EC%A7%80%EB%A7%89-%EC%85%80-%EC%B0%BE%EA%B8%B0\">4) 마지막 셀 찾기</a></li>\n<li><a href=\"#5-%EC%97%B0%EC%82%B0-%EC%88%98%ED%96%89\">5) 연산 수행</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%ED%8A%B8%EB%A6%AC%EA%B1%B0\">트리거</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%82%98%EC%9D%98-%EC%86%8C%EA%B0%90\">나의 소감</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"May 27, 2024","title":"Google Apps Script","categories":"Google_Sheets","author":"신승민","emoji":"🪖"},"fields":{"slug":"/Apps Script/"}},"site":{"siteMetadata":{"siteUrl":"https://maljaaa.github.io","comments":{"utterances":{"repo":"maljaaa/maljaaa.github.io"}}}}},"pageContext":{"slug":"/Google Sheets API/","nextSlug":"/Swagger vs Spring REST Docs/","prevSlug":"/Apps Script/"}},"staticQueryHashes":["1073350324","1956554647","2938748437"]}